Start-Transcript "$env:ProgramData\Microsoft\IntuneManagementExtension\Logs\Installation_copieur_Xerox.log"

# VERIF VERSION POWERSHELL

# Définir le chemin complet du script en utilisant $PSScriptRoot et le nom du script
$scriptName = "Script_INSTALL_CONFIG_PRINTERS_and_Task_planner.ps1"
$scriptPath = Join-Path -Path $PSScriptRoot -ChildPath $scriptName

# Vérifier si le script s'exécute en mode 32 bits
if ([IntPtr]::Size -eq 4) {
    Write-Output "Le script s'exécute en mode 32 bits. Tentative de redémarrage en mode 64 bits..."

    # Construire le chemin vers PowerShell 64 bits
    $powershell64 = "$env:SystemRoot\SysNative\WindowsPowerShell\v1.0\powershell.exe"

    # Vérifier si le chemin existe
    if (Test-Path $powershell64) {
        Write-Output "Le chemin vers PowerShell 64 bits est correct : $powershell64"

        # Vérifier si le chemin du script est défini et correct
        if (-not (Test-Path $scriptPath)) {
            Write-Output "Le chemin du script n'est pas valide : $scriptPath"
            Exit 1
        }

        # Re-exécuter le script en mode 64 bits en utilisant le chemin actuel du script
        Write-Output "Redémarrage du script en mode 64 bits : $scriptPath"
        Start-Process -FilePath "$powershell64" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File `"$scriptPath`""
        
        # Quitter le script actuel en mode 32 bits
        Exit
    } else {
        Write-Output "Le chemin vers PowerShell 64 bits est incorrect : $powershell64"
        Exit 1
    }
} else {
    Write-Output "Le script s'exécute en mode 64 bits."
}

# COPIE FICHIER CSV

# Chemin source du script (même dossier que ce script PowerShell)
$csvSource = "$PSScriptRoot\Copieurs_Xerox.csv"
# Chemin de destination pour le script
$csvDestination = "C:\Copieurs_Xerox.csv"

# Copier le script depuis le dossier source vers le dossier de destination
Copy-Item -Path $csvSource -Destination $csvDestination -Force

# COPIE SCRIPT

# Nom de la tâche planifiée
$taskName = "Xerox MAJ Color Pref Printer"

# Chemin source du script (même dossier que ce script PowerShell)
$scriptSource = "$PSScriptRoot\Script_MAJ_COLOR_PREF_PRINTERS.ps1"
# Chemin de destination pour le script
$scriptDestination = "C:\Script_MAJ_COLOR_PREF_PRINTERS.ps1"

# Copier le script depuis le dossier source vers le dossier de destination
Write-Output "Copie du script depuis $scriptSource vers $scriptDestination..."
Copy-Item -Path $scriptSource -Destination $scriptDestination -Force

# COPIE SCRIPT TASK PLANNER COLOR

# Chemin source du script (même dossier que ce script PowerShell)z
$scriptSource = "$PSScriptRoot\TASK_PLANNER_COLOR.ps1"
# Chemin de destination pour le script
$scriptDestination = "C:\TASK_PLANNER_COLOR.ps1"

# Copier le script depuis le dossier source vers le dossier de destination
Write-Output "Copie du script depuis $scriptSource vers $scriptDestination..."
Copy-Item -Path $scriptSource -Destination $scriptDestination -Force


# DRIVERS

# Chemin complet vers pnputil.exe
$pnputilPath = "C:\Windows\System32\pnputil.exe"

# Chemin vers les fichiers de pilote
$driverPath = "$PSScriptRoot\UNIV_5.951.9.0_PCL6_x64_Driver.inf" # Remplacez par le chemin réel vers le dossier contenant les fichiers de pilote

# Fichier INF du pilote
$infFile = "$driverPath\x3UNIVX.inf"

# Nom du pilote d'imprimante
$printerDriverName = "Xerox Global Print Driver PCL6"

# Vérifier si le fichier INF existe
if (Test-Path $infFile) {
    # Vérifier si pnputil.exe existe
    if (Test-Path $pnputilPath) {
        # Utiliser pnputil.exe pour installer les pilotes
        & $pnputilPath -a $infFile
        if ($LASTEXITCODE -eq 0) {
            Write-Output "Pilote installé avec succès à partir de $infFile."
        } else {
            Write-Output "Échec de l'installation du pilote à partir de $infFile."
            Exit 1
        }
    } else {
        Write-Output "pnputil.exe n'a pas été trouvé dans C:\Windows\System32. Assurez-vous que le chemin est correct."
        Exit 1
    }
} else {
    Write-Output "Le fichier INF $infFile n'a pas été trouvé. Vérifiez le chemin et réessayez."
    Exit 1
}


# Ajouter le pilote d'imprimante
Add-PrinterDriver -Name $printerDriverName -ErrorAction SilentlyContinue

# Vérifier si le pilote est installé
$driver = Get-PrinterDriver -Name $printerDriverName -ErrorAction SilentlyContinue

if ($driver) {
    Write-Output "Le pilote '$printerDriverName' a été installe avec succès."
} else {
    Write-Output "Échec de l'installation du pilote '$printerDriverName'."
    Exit 1
}


# LECTURE FICHIER CSV


# Importer le fichier CSV avec des points-virgules comme séparateurs
$csvPath = "C:\Copieurs_Xerox.csv"
$printers = Import-Csv -Path $csvPath -Delimiter ";"

# Vérification si le fichier CSV est correctement chargé
if ($printers -eq $null) {
    Write-Output "Erreur lors de l'importation du fichier CSV. Verifiez le chemin et le format du fichier."
    exit 1
}

# BOUCLE PRINCIPALE

# Parcourir chaque ligne du fichier CSV
foreach ($printer in $printers) {
    # Définir les variables pour l'imprimante
    $printerName = "$($printer.Antenne) $($printer.Bureau)"
    $printerIP = $printer.IP
    $driverName = "Xerox Global Print Driver PCL6"
    
    # Nom du port
    $portName = $printerName

    # Vérifier et ajouter le port d'imprimante si nécessaire
    $existingPort = Get-PrinterPort -Name $portName -ErrorAction SilentlyContinue

    if (!$existingPort) {
        Add-PrinterPort -Name $portName -PrinterHostAddress $printerIP
        Write-Output "Port $portName cree."
    } else {
        Write-Output "Port $portName existe deja."
    }

    # Ajouter l'imprimante réseau
    $existingPrinter = Get-Printer -Name $printerName -ErrorAction SilentlyContinue
    if (!$existingPrinter) {
        Add-Printer -Name $printerName -DriverName $driverName -PortName $portName
        Write-Output "L'imprimante $printerName a été installee."
    } else {
        Write-Output "L'imprimante $printerName existe deja."
    }

    # PARAMETRAGE SUIVI COULEURS

	# XRX DEVICE SETTINGS

	# Définir le chemin de la clé de registre
	$regPath = "HKLM:\SYSTEM\CurrentControlSet\Control\Print\Printers\$printerName\PrinterDriverData"

	# Valeurs hexadécimales pour XrxDeviceSettings
	$hexXrxDeviceSettings = @(
		0x10,0x00,0x00,0x00,0x01,0x00,0x07,0x20,0x3f,0x17,0x84,0x03,0x00,0x00,0x00,0x00,
		0x4d,0x53,0x43,0x46,0x00,0x00,0x00,0x00,0x77,0x03,0x00,0x00,0x00,0x00,0x00,0x00,
		0x2c,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0x01,0x01,0x00,0x01,0x00,0x00,0x00,
		0x39,0x30,0x00,0x00,0x52,0x00,0x00,0x00,0x01,0x00,0x01,0x00,0x9f,0x06,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x2f,0x2f,0x55,0x6e,0x63,
		0x6f,0x6d,0x70,0x72,0x65,0x73,0x73,0x65,0x64,0x2d,0x44,0x61,0x74,0x61,0x2f,0x2f,
		0x00,0xc3,0x85,0x0e,0xde,0x1d,0x03,0x9f,0x06,0x43,0x4b,0x95,0x54,0x4b,0x48,0x54,
		0x61,0x14,0x3e,0xf3,0xdf,0x3b,0x96,0x5a,0xb9,0xd0,0x69,0xa2,0xd2,0xc6,0x08,0xd3,
		0x94,0xa9,0x19,0x73,0x4a,0x8d,0x64,0xa6,0x30,0x06,0x26,0x91,0x51,0xc2,0x45,0xf4,
		0x2e,0x88,0xc4,0x09,0x1b,0xa1,0x85,0x10,0xe4,0xf8,0x48,0xb3,0x97,0x91,0x45,0x10,
		0x6d,0x7a,0x82,0x9b,0xa0,0x55,0x44,0x6d,0x82,0x20,0x82,0x70,0xd3,0xa2,0xda,0xb4,
		0xc8,0x1e,0x42,0x66,0x66,0x98,0x06,0x9d,0xd7,0xf5,0x2e,0x5a,0x39,0x70,0xff,0xef,
		0x9b,0xf3,0x9f,0xf3,0x9f,0xf3,0x9f,0xf3,0xdd,0x1b,0x8d,0x35,0x34,0xd5,0xf9,0x33,
		0x16,0xe0,0x2f,0x1a,0x8b,0x27,0xa2,0xb1,0x64,0x22,0xdb,0x83,0x7f,0x72,0x01,0xce,
		0x64,0x91,0x2d,0x99,0x30,0xe7,0x0d,0x80,0x01,0xfb,0xed,0x3a,0x84,0x41,0x1b,0xc0,
		0x8b,0x78,0x41,0xf1,0x37,0x10,0x7a,0x4c,0xa1,0x87,0x7d,0x86,0xcb,0x11,0x6e,0x59,
		0x14,0xef,0xe9,0x03,0x8d,0x0f,0x5a,0xbc,0xd7,0x52,0x82,0x90,0x25,0x7e,0x4f,0x8a,
		0x10,0x72,0x84,0x4f,0x10,0x3f,0x64,0x33,0x7f,0x49,0xf1,0x0f,0xc5,0xff,0x45,0x21,
		0xe5,0x93,0xdc,0xef,0x28,0xf7,0x1d,0xb1,0xef,0xa3,0x73,0x16,0x6b,0x3e,0x8a,0x5d,
		0x24,0xbc,0x95,0xf8,0x77,0x70,0x63,0xf3,0xc4,0xfe,0x98,0xec,0x45,0x78,0x8e,0x0d,
		0x3e,0x68,0x81,0xa3,0xd0,0x0e,0x29,0x38,0x0d,0x01,0xd8,0xc3,0xfc,0x14,0x1c,0x84,
		0x04,0x1c,0x87,0x36,0x38,0x81,0xb6,0x1d,0xb0,0x05,0x36,0x41,0x18,0x1f,0x33,0xc4,
		0x21,0x18,0x3b,0xa4,0x77,0x6d,0x42,0x03,0x77,0x0a,0x4c,0xbe,0x94,0x3b,0xb3,0x01,
		0x21,0xc9,0xe6,0x8c,0x55,0xe7,0x37,0x03,0xea,0xd9,0x67,0x53,0x68,0xf9,0x02,0xb2,
		0x05,0x60,0x37,0x74,0x40,0x2b,0xa4,0x71,0xef,0x18,0xb2,0x36,0x38,0xcc,0x3c,0x85,
		0x2c,0x00,0x8d,0x18,0x49,0x31,0x69,0x3e,0xc3,0x5c,0x33,0x92,0x66,0x0d,0x57,0x68,
		0x43,0x03,0x06,0x47,0x21,0x09,0x66,0xbf,0x74,0xcb,0xb7,0x16,0x21,0xc0,0x65,0xd1,
		0x2c,0x4d,0x33,0xfb,0x79,0xb1,0x8c,0x4a,0x4c,0x55,0x05,0xd5,0x60,0xce,0x71,0x85,
		0xc5,0x10,0x82,0x20,0x1a,0x83,0x10,0xc1,0x87,0xf8,0x66,0xc5,0x30,0xba,0x91,0x7d,
		0x2b,0xef,0x85,0xd5,0x5a,0xc9,0xfb,0x61,0x7d,0x42,0xfc,0x98,0x31,0x69,0xf3,0xa3,
		0x62,0x84,0xcf,0x1e,0xed,0xd9,0x65,0x9b,0xb2,0xdf,0xa6,0x2a,0x27,0x64,0x24,0xef,
		0x69,0x24,0x97,0xa4,0x6f,0x81,0x0a,0x84,0x1f,0x62,0xff,0x48,0xf6,0x49,0xe1,0xe3,
		0xc4,0x7f,0x0a,0x9f,0x26,0x3e,0x2d,0x1c,0x68,0x84,0xdf,0x2c,0xb9,0xf5,0xb8,0x62,
		0x8e,0x62,0xae,0xe2,0x12,0xc5,0x0f,0xee,0x98,0xbe,0x6a,0xa3,0xa6,0x40,0xcb,0xea,
		0xd4,0x01,0xfd,0x72,0x0c,0x93,0xa2,0xa9,0xd4,0x7a,0x84,0xb8,0x2d,0x5a,0xae,0xe5,
		0x03,0xbc,0xb4,0xed,0x55,0x7f,0x9f,0xd4,0x9d,0x4d,0xf2,0xb4,0x85,0x8f,0xd2,0xec,
		0x2d,0xe1,0x53,0xc4,0xb3,0x6c,0x96,0xfd,0x2e,0x47,0xf6,0x19,0xa7,0x17,0xdd,0x9e,
		0xf9,0x82,0x06,0x1d,0x5b,0x8f,0x43,0x7a,0xdd,0xcd,0x7e,0xc7,0x36,0xe0,0x90,0x39,
		0xb9,0x7e,0x19,0x5d,0xff,0xa6,0x23,0xc7,0xab,0x32,0xe4,0x39,0x7a,0x25,0x3e,0x49,
		0xef,0x47,0xa8,0xf7,0xc6,0x56,0x87,0x12,0xbd,0xc7,0x49,0x23,0x2a,0xac,0xc2,0x39,
		0x55,0xe3,0x1a,0x62,0x0c,0xa2,0x04,0x1a,0x50,0x53,0x61,0x56,0x5e,0x25,0xff,0x8f,
		0xe8,0x5a,0x8b,0xf6,0x9d,0xa8,0xca,0x46,0xa8,0x41,0xe6,0xc8,0xaa,0xf4,0xbf,0x13,
		0x42,0x50,0x06,0x26,0x25,0x75,0x74,0x92,0xd8,0xae,0x6b,0xa3,0x6f,0x28,0x7a,0xf8,
		0x06,0xb9,0xe8,0x58,0xad,0x52,0x89,0xb0,0x94,0x42,0x2c,0x29,0x63,0x39,0x17,0xb4,
		0x1d,0x92,0xad,0xc3,0xfb,0xa2,0x07,0xbc,0x51,0x1c,0xd6,0x01,0x5c,0x71,0x50,0x92,
		0xce,0xd2,0xe5,0x67,0x80,0x5a,0x57,0x40,0xe1,0x15,0x32,0xc6,0x38,0x7d,0x1a,0x1e,
		0xb8,0x1d,0xbd,0xef,0xd2,0x7b,0x2e,0xbd,0xeb,0xd2,0x8b,0x7a,0xec,0x2b,0x89,0xdf,
		0x56,0x8a,0xb0,0x57,0x78,0x86,0xce,0x1a,0x93,0x01,0x3c,0x5f,0x8d,0x30,0xa2,0x25,
		0x8e,0x2a,0x46,0x14,0x97,0x2a,0x2e,0xb3,0xa4,0xed,0x79,0x8a,0xf9,0x8a,0x3e,0xc5,
		0xe5,0x8a,0x7e,0xc5,0x15,0x8a,0xc5,0x8a,0x7f,0x25,0xd7,0x2a,0xd2,0x7d,0x5a,0xae,
		0xd9,0x45,0xbd,0x3d,0x2b,0x1a,0xf3,0xd3,0x3b,0xd3,0x25,0x7c,0x25,0x71,0x90,0xd9,
		0xd7,0x93,0x38,0xb6,0xb3,0xbf,0x77,0x41,0xdf,0xb7,0x6e,0x6d,0x71,0x8f,0xe4,0x3a,
		0x40,0xb9,0x7a,0x85,0x77,0x10,0xff,0xe3,0xb6,0x77,0x56,0x4a,0x2b,0xa0,0x54,0xfd,
		0xe2,0xf2,0x94,0x26,0xd0,0xcf,0x92,0x2b,0x40,0xbd,0xa4,0x30,0x53,0x1a,0xcf,0x6f,
		0x66,0xf5,0x6c,0x84,0x38,0xae,0x01,0xcc,0x9d,0xc6,0xec,0x6d,0x70,0x04,0xd7,0x76,
		0x5c,0x4d,0xbd,0xf6,0xea,0x99,0xe2,0x6b,0xe9,0x75,0x0d,0xf5,0x3d,0x63,0xcf,0x7f,
		0xb0,0x3a,0x54,0xeb,0xff,0x00,0x02,0xff,0xff,0xff,0xff,0x00,0x00,0x06,0x9f,0x43,
		0x4f,0x4d,0x35
	)

	# Convertir les valeurs hexadécimales en un tableau de bytes
	$binaryData = [byte[]]$hexXrxDeviceSettings

	# Écrire les valeurs binaires dans le registre
	Set-ItemProperty -Path $regPath -Name "XrxDeviceSettings" -Value $binaryData


	# ADMIN DEV DEFAULTS

	# Valeurs hexadécimales pour AdminDevDefaults
	$hexAdminDevDefaults = @(
		0x10,0x00,0x00,0x00,0x01,0x00,0x07,0x20,0x3f,0x17,0x84,0x03,0x00,0x00,0x00,0x00,0x4d,0x53,
		0x43,0x46,0x00,0x00,0x00,0x00,0xe5,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x2c,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x03,0x01,0x01,0x00,0x01,0x00,0x00,0x00,0x39,0x30,0x00,0x00,0x52,0x00,
		0x00,0x00,0x01,0x00,0x01,0x00,0x21,0x05,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x2f,0x2f,0x55,0x6e,0x63,0x6f,0x6d,0x70,0x72,0x65,0x73,0x73,0x65,0x64,
		0x2d,0x44,0x61,0x74,0x61,0x2f,0x2f,0x00,0x5d,0xb3,0xc8,0xf7,0x8b,0x02,0x21,0x05,0x43,0x4b,
		0x95,0x54,0x4b,0x68,0x13,0x51,0x14,0x3d,0xf3,0x66,0xa2,0xa6,0x55,0xbb,0xa8,0x31,0xa2,0xb6,
		0x4e,0x44,0x4a,0xb5,0x25,0x98,0x89,0x8d,0xb6,0x0a,0x25,0x51,0x0a,0x81,0x18,0x4a,0x2a,0xd2,
		0x85,0xf8,0x45,0x41,0x2c,0x8d,0x68,0x02,0x2e,0x5c,0xd9,0xa8,0xf5,0xff,0xa9,0x58,0xdd,0x88,
		0x1b,0x37,0x42,0x97,0xae,0x44,0x70,0x23,0x08,0x22,0x48,0x37,0x2e,0xaa,0x1b,0x17,0x7e,0xda,
		0x82,0x55,0x6b,0xc1,0x1f,0x78,0xef,0xbb,0x77,0xe8,0xc2,0x95,0x81,0x37,0xe7,0xcc,0x79,0xef,
		0xbe,0x7b,0xdf,0x3d,0x6f,0x92,0xcd,0x15,0xfb,0xba,0xe3,0x35,0x17,0xf4,0xcb,0xe6,0xf2,0x85,
		0x6c,0xae,0x54,0x88,0x1a,0x7a,0xa9,0x07,0x9c,0x08,0x6b,0xa5,0x82,0xb9,0x4c,0x82,0x81,0xf7,
		0x7a,0x1d,0xc1,0x15,0x0f,0x20,0xdd,0x5c,0x55,0x6c,0x72,0xec,0xdc,0x68,0x1b,0xc1,0x3d,0x97,
		0xe3,0x9c,0x61,0x68,0x5c,0xd2,0xb5,0x73,0xfd,0x2d,0x04,0x0b,0x64,0xdd,0xe3,0x66,0x82,0x3a,
		0xe1,0x33,0xcc,0x0f,0x7a,0x96,0x3f,0xe7,0xf8,0x87,0xb2,0xfe,0x59,0x13,0xe7,0x91,0x9c,0x13,
		0x9c,0xf3,0x81,0xe8,0x7b,0x79,0x9f,0x45,0x9a,0x8f,0x63,0x17,0x0a,0x1f,0x60,0xfe,0x19,0xf3,
		0xb1,0x0d,0xa2,0x3f,0x62,0xbd,0x99,0xf6,0xf1,0x10,0x43,0x3f,0x0e,0xe3,0x04,0xca,0x38,0x05,
		0x1f,0xbb,0x2d,0x3f,0x89,0x03,0x28,0xe0,0x28,0x06,0x71,0x8c,0xb4,0xed,0xd8,0x8c,0x8d,0x08,
		0x68,0x98,0x11,0x1b,0x42,0xb1,0x23,0x7a,0xc6,0x3e,0x12,0x6c,0x87,0x60,0x1a,0xa5,0xdc,0x1f,
		0x1b,0x08,0x4a,0x56,0xae,0xb9,0xdd,0x71,0x73,0x49,0x57,0x0e,0x7b,0x1c,0xda,0xf6,0x1f,0xd9,
		0x7c,0xec,0x44,0x15,0x03,0xa8,0xd0,0xdc,0x11,0x62,0x83,0x38,0x64,0x79,0x99,0x98,0x8f,0x5e,
		0x8a,0xe4,0x98,0x8a,0xdd,0xc3,0xdc,0x36,0x92,0x66,0x8d,0xad,0xd0,0x43,0x91,0x82,0xb3,0x28,
		0xc1,0xec,0x93,0x6e,0xc5,0xd6,0x12,0xf8,0xb6,0x2c,0x87,0xab,0xdd,0x65,0xd7,0x45,0xa8,0x8c,
		0x34,0xa5,0xea,0x40,0x27,0xcc,0x05,0x5b,0x61,0x02,0x29,0x24,0x49,0x4c,0x22,0x43,0x83,0xf9,
		0x26,0xc5,0x80,0x96,0xb1,0xbe,0xc5,0xce,0x05,0xaa,0xa6,0xed,0x7c,0xa0,0x23,0x65,0x87,0xf9,
		0xe8,0x68,0x9f,0x6e,0x78,0x9c,0xf1,0x3e,0x57,0x36,0x23,0x36,0xbc,0x61,0x1b,0xae,0x4b,0xaf,
		0xfc,0x76,0x82,0x2f,0xa2,0xbf,0x63,0xfd,0xab,0xf0,0x69,0xe6,0xdf,0x84,0xcf,0x31,0x9f,0x13,
		0x0e,0xb6,0x6d,0xca,0x95,0x93,0x4e,0x2b,0xd6,0x29,0xd6,0x2b,0x2e,0x56,0x7c,0x3b,0x6f,0xcd,
		0xa4,0x36,0x67,0x16,0x5a,0xd6,0xf7,0x90,0xe4,0xad,0x3b,0x8e,0x89,0xa8,0x4b,0x31,0x29,0x2c,
		0xca,0x77,0xce,0x13,0x3e,0xce,0x86,0xba,0xc2,0x67,0x99,0xdf,0x92,0x8e,0xfe,0xe6,0xfb,0xf7,
		0x5e,0xee,0xd3,0x58,0x82,0xa0,0x45,0xf7,0x3a,0x6e,0xc4,0xe9,0x0e,0xea,0x45,0x27,0x3d,0x53,
		0x16,0x93,0xd4,0xe6,0x22,0xf9,0x16,0x58,0x77,0xd3,0xf6,0x3d,0xa3,0xcf,0xad,0xa4,0xef,0x20,
		0xe7,0x7b,0xd1,0x45,0x2c,0xb4,0xae,0xf5,0x9f,0x1d,0x52,0x58,0x0f,0x53,0x96,0xf4,0xa7,0xd9,
		0xd0,0x3b,0x7a,0xb0,0xbb,0x8a,0x6e,0xd8,0x77,0x2f,0x24,0x51,0xed,0xc6,0x27,0x5d,0xf1,0x4a,
		0x71,0x54,0x0f,0x7c,0x33,0x44,0xd9,0xf5,0x17,0x1f,0xaa,0x5d,0x3e,0xaa,0x3c,0x7f,0x54,0xd7,
		0x74,0xfe,0x85,0x68,0xdb,0x5a,0x09,0xf6,0x08,0xaf,0xf1,0xfc,0x07,0x71,0xe6,0xe9,0x6a,0x82,
		0x31,0xcd,0x35,0xae,0x98,0x51,0x5c,0xa2,0xb8,0xd4,0x95,0x06,0x35,0x28,0x36,0x2a,0xc6,0x14,
		0x97,0x2b,0xc6,0x15,0x57,0x28,0x26,0x14,0xff,0x48,0xae,0x55,0x7c,0x23,0x2a,0x52,0xef,0x10,
		0x77,0xe1,0x8c,0x98,0x13,0xe7,0xdb,0x34,0x24,0x7c,0x25,0x73,0x88,0x39,0x3d,0x7c,0x6b,0xce,
		0xea,0xb9,0xcf,0x49,0xdc,0x7e,0x8e,0x3b,0x2f,0xbc,0xca,0xfc,0x27,0xf8,0xb6,0x2c,0xe3,0x0c,
		0x17,0x45,0x7e,0xc2,0xad,0xe8,0xd1,0xd2,0x5f,0xca,0x91,0xbb,0xf8,0xf8,0x55,0xfd,0x13,0xf8,
		0x0b,0x02,0xff,0xff,0xff,0xff,0x00,0x00,0x05,0x21,0x43,0x4f,0x4d,0x35
	)

	# Convertir les valeurs hexadécimales en un tableau de bytes
	$binaryData = [byte[]]$hexAdminDevDefaults

	# Écrire les valeurs binaires dans le registre
	Set-ItemProperty -Path $regPath -Name "AdminDevDefaults" -Value $binaryData

}


Stop-Transcript

Exit 0
